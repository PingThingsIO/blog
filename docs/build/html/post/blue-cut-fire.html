
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Calculating Frequency from Unwrapped Phase &#8212; NI4AI Blog 0.1 documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/blank.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/tree.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    
      
      <link rel="icon" sizes="16x16" href="../_static/_static/tree.png">
      
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/PingThings_logo_color.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="index.html">
  Blog Posts
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://btrdb.readthedocs.io/en/latest/">API Docs<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://btrdb.readthedocs.io/en/latest/">PingThings<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PingThingsIO/ni4ai-notebooks" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.pingthings.io/" rel="noopener" target="_blank" title="PingThings">
            <span><i class="fa"></i></span>
            <label class="sr-only">PingThings</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <p>On August 16th, 2016, the Blue Cut Fire in Southern California caused a transmission line fault, which in turn caused the grid frequency to drop. This event was recorded by the Western Interconnection Frequency (shown in the figure below) and analyzed by the <a class="reference external" href="https://www.nerc.com/Pages/default.aspx">North American Reliability Corporation</a> (NERC). In this blog post we will locate this event on the <a class="reference external" href="https://data.world/datasets/sunshine">Sunshine dataset</a> and compare the event as reported by NERC, and as evidenced in the Sunshine data.</p>
<p><img alt="Figure 1" src="assets/images/post/blue-cut-fire/wecc_event.png" />
<a class="reference external" href="https://www.nerc.com/pa/rrm/ea/1200_MW_Fault_Induced_Solar_Photovoltaic_Resource_/1200_MW_Fault_Induced_Solar_Photovoltaic_Resource_Interruption_Final.pdf">Read the NERC report.</a></p>
<p>This drop in frequency caused solar inverters to trip offline. The solar inverters have a built-in phase-locked loop (PLL) to measure grid frequency and are programmed to automatically disconnect from the grid if the grid frequency is less than or equal to 57 Hz. However, from the reported frequency plot we see that the grid frequency remained above the 57 Hz threshold. The NERC report concludes that the solar inverters tripped offline because their PLLs overestimated the frequency deviation.</p>
<p><img alt="Figure 2" src="assets/images/post/blue-cut-fire/fire_location.png" /></p>
<p>To compare how micro-PMUs reported the frequency, let us find the event in the Sunshine dataset. The transmission line fault caused by the Blue Cut fire occurred at 6:45pm (UTC), and we see that the sunshine dataset has PMU data reporting data during this event.</p>
<p><img alt="Figure 3" src="assets/images/post/blue-cut-fire/plotter.png" /></p>
<section id="calculating-frequency-from-unwrapped-phase">
<h1>Calculating Frequency from Unwrapped Phase<a class="headerlink" href="#calculating-frequency-from-unwrapped-phase" title="Permalink to this headline">Â¶</a></h1>
<p>Parts one and two of this blog post describe how to obtain and unwrap voltage phase data, and how to take a derivative to calculate the voltage frequency vs time.</p>
<p>Below, we show the phase angle and frequency during the event. We can see that the derivative of phase angle changes at around 16:18:45 UTC. The second figure shows a significant spike in frequency at that time.</p>
<p><img alt="Figure 3" src="assets/images/post/blue-cut-fire/phase_v_time.png" /></p>
<p><img alt="Figure 4" src="assets/images/post/blue-cut-fire/frequency_v_time.png" /></p>
<p>Zooming in to the event, we see that the frequency drops and then peaks before being restored to nominal. This happens within the span of about 0.1 seconds.</p>
<p><img alt="Figure 5" src="assets/images/post/blue-cut-fire/event_profile.png" /></p>
<p>In the real world, primary and secondary frequency response occur on the order of seconds and tens of seconds, respectively. What we are seeing is not the result of droop control, but a transient phenomenon during which the voltage signal does not appear sinusoidal. Therefore, the voltage phase angle and the frequency are ill defined during this transient event.</p>
<p>The short timescale of the event is exacerbated by the fact that the derivative is essentially a high-pass filter: the high-frequency components of the voltage phase signal are amplified by computing a numerical derivative. To get rid of the noise introduced by taking a derivative, we need to apply a low-pass filter to the signal. Below are the results of applying a <a class="reference external" href="https://en.wikipedia.org/wiki/Moving_average">moving average filter</a> to the frequency using a 0.1 second window and a longer 0.5 second window.</p>
<p><img alt="Figure 6" src="assets/images/post/blue-cut-fire/short_window.png" /></p>
<p><img alt="Figure 7" src="assets/images/post/blue-cut-fire/long_window.png" /></p>
<p>Now our data looks the same as the Western Interconnection Frequency reported by NERC, which provides us an idea of how the raw signal is processed. The frequency is not well defined during rapid disturbance events, but applying a low-pass filter will attenuate the high-frequency artifacts and yield a signal that is less likely to cause solar inverters to needlessly trip offline.</p>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, PingThings.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>